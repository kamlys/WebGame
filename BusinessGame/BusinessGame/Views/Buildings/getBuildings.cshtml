@model IEnumerable<BusinessGame.Models.Buildings>
<div class="row">
    <div class="col-md-3" id="dvSource">
        @foreach (var m in @Model)
        {
            <p style="z-index:1; color:white; padding:10px; display:block; background-color:brown; text-align:center; padding-top:25px; width:50px; height:50px; border:1px solid black">
            @foreach (var a in @m.Name.Split('_'))
            {
                @a[0]
            }
               
            </p>
        }
    </div>
    <div class="col-md-9">
        <table style="z-index: 1000">
        @for (int i = 0; i < 10; i++)
        {
            <tr>
                @for (int j = 0; j < 10; j++)
                {
                    if (j == 4 && i == 3 || i == 2 && j == 7)
                    {
                        <td id="@i-@j" style="background-color:green; width:60px; height:60px; border:4px solid black" class="target free"></td>
                    }
                    else
                    {
                        <td id="@i-@j"  style="background-color:gray; width:60px; height:60px; border:4px solid black" class="target"></td>
                    }
                }
            </tr>
        }
    </table>
    </div>
</div>

@section Scripts {
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="http://code.jquery.com/ui/1.8.24/jquery-ui.min.js" type="text/javascript"></script>
<link href="http://code.jquery.com/ui/1.8.24/themes/blitzer/jquery-ui.css" rel="stylesheet"
      type="text/css" />
<script src="@Url.Content("~/Scripts/colorbox/jquery.colorbox.js")"></script>

<script type="text/javascript">

    $(init);

    function init() {
        $("#dvSource p").draggable({
            revert: "invalid",
            refreshPositions: true,
            drag: function (event, ui) {
                ui.helper.addClass("draggable");
            }
        });
        $(".target.free").droppable({
            tolerance: 'fit',
            drop: function (event, ui) {
                $(this).append(ui.draggable.css('position', 'static'))
                submitAjax(event.target.id);
            }
        });
    }

    function submitAjax(location) {
        $.colorbox({ html: "Stawianie budynku na pozycji" + location });
        $.ajax({
            url: '/Buildings/CreateUserBuilding',
            type: 'POST',
            data: JSON.stringify(location),
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            error: function (xhr) {
                $.colorbox({ html: 'Error: ' + xhr.statusText });
            },
            success: function (result) {
                $.colorbox({ html: result });
                $(location).removeClass('free');
            },
            async: true,
            processData: false
        });
    }

</script>
}

@section css {
    <link href="@Url.Content("~/Content/colorbox/colorbox.css")" rel="stylesheet" type="text/css" />
}